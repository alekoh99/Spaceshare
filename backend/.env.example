# ═══════════════════════════════════════════════════════════════════
# SPACESHARE BACKEND SECURITY CONFIGURATION (Example)
# ═══════════════════════════════════════════════════════════════════
# IMPORTANT: Copy this file to .env and update all values for your environment
# Never commit .env to version control
# ═══════════════════════════════════════════════════════════════════

# === APPLICATION ===
PORT=8080
NODE_ENV=production

# CRITICAL: Generate a strong JWT secret
# Command: openssl rand -base64 32
JWT_SECRET=YOUR_SECURE_32_CHAR_JWT_SECRET_HERE
JWT_EXPIRE=7d
JWT_REFRESH_EXPIRE=30d
JWT_ALGORITHM=HS256

# === DATABASE SECURITY ===
# PostgreSQL: Change all default credentials immediately
DATABASE_URL=postgresql://username:password@db.internal:5432/spaceshare_db
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_CONN_TIMEOUT=30000
DB_IDLE_TIMEOUT=900000
DB_SSL_MODE=require

# MongoDB: Use Atlas with authentication
# Format: mongodb+srv://username:password@cluster.mongodb.net/database?authSource=admin&retryWrites=true&w=majority
MONGO_URI=mongodb+srv://username:password@cluster.mongodb.net/spaceshare?authSource=admin
MONGO_CONNECTION_LIMIT=50
MONGO_POOL_SIZE=10

# === FIREBASE SECURITY ===
FIREBASE_SERVICE_ACCOUNT_PATH=../serviceAccountKey.json
FIREBASE_DATABASE_URL=https://your-project.firebaseio.com
FIREBASE_API_KEY=YOUR_FIREBASE_API_KEY

# === SECURITY HEADERS ===
# Set to your production domain
CORS_ORIGIN=https://yourdomain.com
CORS_CREDENTIALS=true
CORS_MAX_AGE=86400

# === RATE LIMITING ===
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100
RATE_LIMIT_AUTH_MAX_REQUESTS=50
RATE_LIMIT_STRICT_MAX_REQUESTS=5

# === API SECURITY ===
MAX_REQUEST_SIZE=10mb
HELMET_ENABLED=true
REQUEST_TIMEOUT=30000
ENABLE_REQUEST_SIGNING=false
REQUEST_SIGNING_KEY=YOUR_REQUEST_SIGNING_KEY_MIN_32_CHARS

# === AUTHENTICATION ===
SESSION_SECRET=YOUR_SECURE_32_CHAR_SESSION_SECRET
PASSWORD_MIN_LENGTH=12
PASSWORD_REQUIRE_SPECIAL_CHARS=true
PASSWORD_REQUIRE_NUMBERS=true
PASSWORD_REQUIRE_UPPERCASE=true

# === DATA ENCRYPTION ===
# Generate with: openssl enc -aes-256-cbc -S 0 -P -pass pass:"YOUR_PASSPHRASE" -nosalt
ENCRYPTION_ALGORITHM=aes-256-gcm
ENCRYPTION_KEY=YOUR_32_BYTE_ENCRYPTION_KEY_IN_HEX
ENCRYPTION_IV=YOUR_16_BYTE_INITIALIZATION_VECTOR

# === LOGGING & MONITORING ===
LOG_LEVEL=info
LOG_REQUEST_BODY=false
LOG_RESPONSE_BODY=false
LOG_SENSITIVE_DATA=false
SENTRY_DSN=https://your-sentry-key@sentry.io/project-id

# === API KEYS & TOKENS ===
API_KEY_EXPIRATION=86400000
REFRESH_TOKEN_EXPIRATION=2592000000
MFA_ENABLED=false
MFA_WINDOW_TIME=30

# === SECURITY FEATURES ===
ENABLE_HTTP_ONLY_COOKIES=true
ENABLE_SECURE_COOKIES=true
ENABLE_SAME_SITE_COOKIES=Strict
ENABLE_CSRF_PROTECTION=true
ENABLE_XSS_PROTECTION=true
ENABLE_CONTENT_SECURITY_POLICY=true

# === BACKUP & RECOVERY ===
BACKUP_RETENTION_DAYS=30
ENABLE_POINT_IN_TIME_RECOVERY=true

# === COMPLIANCE ===
DATA_RETENTION_DAYS=365
GDPR_COMPLIANT=true
AUDIT_LOG_ENABLED=true

# ═══════════════════════════════════════════════════════════════════
# SECURITY CHECKLIST
# ═══════════════════════════════════════════════════════════════════
# [ ] Update JWT_SECRET with strong random value
# [ ] Update DATABASE_URL with real PostgreSQL credentials
# [ ] Update MONGO_URI with MongoDB Atlas connection string
# [ ] Update CORS_ORIGIN with actual domain
# [ ] Update ENCRYPTION_KEY and ENCRYPTION_IV
# [ ] Update FIREBASE credentials
# [ ] Set NODE_ENV=production for production deployments
# [ ] Enable HTTPS in production
# [ ] Set up backup strategy
# [ ] Configure monitoring and alerting
# [ ] Enable MFA if using sensitive data
# [ ] Set proper firewall rules on database servers
# [ ] Enable SSL/TLS for all database connections
# [ ] Configure VPN/Private networking
# [ ] Set up audit logging
# [ ] Review CORS_ORIGIN carefully (no wildcards in production)
# [ ] Enable rate limiting for all routes
